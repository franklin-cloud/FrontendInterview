<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
**Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)*

- [浏览器的跨域问题](#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

### 浏览器的跨域问题
**跨域的来源**
> 跨域是因为浏览器的同源策略限制了不同源的访问。同源策略是一种浏览器的安全功能，它限制一个源上的文档和脚本如何与另一个源的资源交互。
同源是指：协议相同、域名相同、端口相同。

**跨域的影响**
同源策略规定AJAX的请求只能发给同源的服务，否则浏览器就是报错，中断请求。
- Cookie、LocalStorage 和 IndexDB 无法读取；
- DOM 无法获得；
- AJAX 请求不能发送；

**AJAX跨域如何解决**

- JSONP 创建script标签进行请求，仅支持Get请求(CORS规则对标签请求没有那么严格)

- CORS 跨域资源共享(cross-origin-resource-sharing)，浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not simple request）。
**简单请求**：浏览器自动在头信息之中添加一个请求源origin字段，origin字段用来说明本次请求来自哪个源（协议 + 域名 + 端口），服务器根据这个值，决定是否同意这次请求。
**非简单请求**：会在正式通信之前，增加一次OPTIONS查询请求，称为"预检"请求（preflight），用来询问服务器是否允许访问（origin, 允许的请求方式，是否允许自定义的请求头字段）。
满足以下条件为简单请求：
	1. 请求方法是以下三种方法之一: HEAD, GET, POST
	2. HTTP的头信息不超出以下几种字段: Accept, Accept-Language, Content-Language, Last-Event-ID（使用默认请求头）
	3. Content-Type只限于三个值 application/x-www-form-urlencoded、multipart/form-data、text/plain

- Proxy 代理服务器，浏览器请求代理服务器，再由代理服务器请求外部服务；或者前端启动一个node服务设置响应头Access-Control-Allow-Origin: *,然后再去访问目前服务器（**因为同源策略是针对浏览器的，服务器与服务器间不存在**）

- WebSocket ws(s)协议不实行同源政策，只要服务器支持，就可以通过它进行跨源通信

Proxy 代理服务器流程图
![Proxy 代理服务器流程图](./images/截屏2024-10-05%2022.11.47.png)

[跨域资源共享 CORS 详解——阮一峰](https://www.ruanyifeng.com/blog/2016/04/cors.html)
